{"version":3,"sources":["../src/events.test.js"],"names":["protobuf","require","describe","Message","Block","beforeAll","done","load","err","root","lookupType","test","cout","et","EventTube","evt","ed","Uint8Array","data","msg","decode","console","log","expect","action","toBeGreaterThan","toBeLessThan","toBe"],"mappings":";;AACA;;;;AADA,IAAMA,WAAWC,QAAQ,YAAR,CAAjB;;AAIAC,SAAS,WAAT,EAAsB,YAAM;AACxB,MAAIC,OAAJ,EAAYC,KAAZ;AACAC,YAAU,UAASC,IAAT,EAAe;AACxBN,aAASO,IAAT,CAAc,mBAAd,EAAmC,UAASC,GAAT,EAAcC,IAAd,EAAoB;AAChD,UAAID,GAAJ,EAAQ;AACJ,cAAMA,GAAN;AACH;;AACDL,gBAAUM,KAAKC,UAAL,CAAgB,kBAAhB,CAAV;AACAN,cAAQK,KAAKC,UAAL,CAAgB,kBAAhB,CAAR;AACAJ;AACH,KAPJ;AAQA,GATD;AAWAK,OAAK,cAAL,EAAqB,UAACL,IAAD,EAAU;AAC3B,QAAIM,OAAM,CAAV;AACA,QAAIC,KAAK,IAAIC,eAAJ,CAAc,2BAAd,EAA0C,UAASC,GAAT,EAAa;AAC5D;AACA,UAAIC,KAAK,IAAIC,UAAJ,CAAeF,IAAIG,IAAnB,CAAT;AACA,UAAIC,MAAMhB,QAAQiB,MAAR,CAAeJ,EAAf,CAAV;AACAK,cAAQC,GAAR,CAAYH,GAAZ;AACAI,aAAOJ,IAAIK,MAAX,EAAmBC,eAAnB,CAAmC,CAAnC;AACAF,aAAOJ,IAAIK,MAAX,EAAmBE,YAAnB,CAAgC,EAAhC;AACAd;AACA,UAAGA,OAAK,CAAR,EACIN;AACP,KAVQ,CAAT;AAWAiB,WAAO,IAAE,CAAT,EAAYI,IAAZ,CAAiB,CAAjB;AACH,GAdD;AAgBD,CA7BH","sourcesContent":["const protobuf = require(\"protobufjs\");\nimport EventTube from './events';\n\n\ndescribe('事件订阅与数据获取', () => {\n    var Message,Block;\n    beforeAll(function(done) {\n     protobuf.load(\"protos/peer.proto\", function(err, root) {\n            if (err){\n                throw err;\n            }\n            Message = root.lookupType(\"rep.protos.Event\");\n            Block = root.lookupType(\"rep.protos.Block\");\n            done();\n        });\n    });\n\n    test('订阅RepChain事件', (done) => {\n        var cout =0;\n        var et = new EventTube('ws://localhost:8081/event',function(evt){\n            //console.log(m);\n            var ed = new Uint8Array(evt.data);\n            var msg = Message.decode(ed);\n            console.log(msg)\n            expect(msg.action).toBeGreaterThan(0);\n            expect(msg.action).toBeLessThan(12);\n            cout++;\n            if(cout>2)\n                done();\n        })            \n        expect(1+1).toBe(2);\n    });\n\n  });\n  \n"],"file":"events.test.js"}